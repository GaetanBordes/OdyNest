<section class="container">
  <div class="experience-content">
    <!-- Section Image -->
    <div class="image-container">
      <% if @experience.photo.attached? %>
        <%= image_tag @experience.photo, class: "img-fluid rounded", alt: "Image de l'expérience" %>
      <% else %>
        <%= image_tag 'default-image.jpg', class: "img-fluid rounded", alt: "Image par défaut" %>
      <% end %>
    </div>

    <!-- Section Textes -->
    <div class="text-content">
      <!-- Section Titre -->
      <header class="title-description">
        <h1><%= @experience.title %></h1>
      </header>

      <!-- Section Détails de l'expérience -->
      <section class="details">
        <p><strong>Description :</strong> <%= @experience.description %></p>
        <p><strong>Lieu :</strong> <%= @experience.location %></p>
        <p><strong>Prix :</strong> <%= number_to_currency(@experience.price - 0.01, unit: "", separator: ",", delimiter: ".", format: "%n€") %></p>
        <p><strong>Durée :</strong> <%= @experience.duration %> jours</p>

        <% if current_user && current_user != @experience.provider && !current_user.admin? %>
          <section class="form-container">
            <h4>Choisissez une date :</h4>
            <%= form_with model: Reservation.new, url: experience_reservations_path(@experience), method: :post do |f| %>
              <div class="form-group">
                <%= f.label :reservation_date, "Date de réservation" %>
                <%= f.select :reservation_date, 
                    [[@experience.start_date_1.strftime("%d/%m/%Y"), @experience.start_date_1],
                     [@experience.start_date_2.strftime("%d/%m/%Y"), @experience.start_date_2],
                     [@experience.start_date_3.strftime("%d/%m/%Y"), @experience.start_date_3]],
                    {}, class: "form-control" %>
              </div>
              <%= f.submit "Réserver cette expérience", class: "btn btn-success mt-2" %>
            <% end %>
          </section>
        <% elsif current_user == @experience.provider %>
          <div class="alert alert-warning" role="alert">
            Vous êtes le fournisseur de cette expérience.
          </div>
        <% end %>
      </section>
    </div>
  </div>

  <!-- Section Actions -->
  <footer class="mt-4 text-center">
    <%= link_to 'Retour à la liste des expériences', experiences_path, class: 'btn btn-secondary' %>
    <% if current_user&.admin? || current_provider == @experience.provider %>
      <%= link_to 'Modifier', edit_experience_path(@experience), class: 'btn btn-primary' %>
      <%= form_with url: experience_path(@experience), method: :delete, data: { confirm: 'Êtes-vous sûr de vouloir supprimer cette expérience ?' } do %>
        <button type="submit" class="btn-delete">
          <svg viewBox="0 0 448 512" class="svgIcon">
            <path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path>
          </svg>
        </button>
      <% end %>
    <% end %>
  </footer>
</section>
